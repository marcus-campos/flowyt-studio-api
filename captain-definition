{
  "schemaVersion": 2,
  "dockerfileLines": [
    "FROM python:3.8.1",
    "ENV PYTHONUNBUFFERED 1",

    "ENV SECRET_KEY $SECRET_KEY",
    "ENV DEBUG $DEBUG",
    "ENV DEFAULT_API_URL $DEFAULT_API_URL",
    "ENV ALLOWED_HOSTS $ALLOWED_HOSTS",
    "ENV DATABASE_URL $DATABASE_URL",

    "ENV EMAIL_HOST $EMAIL_HOST",
    "ENV EMAIL_PORT $EMAIL_PORT",
    "ENV EMAIL_HOST_USER $EMAIL_HOST_USER",
    "ENV EMAIL_HOST_PASSWORD $EMAIL_HOST_PASSWORD",
    "ENV EMAIL_USE_TLS $EMAIL_USE_TLS",
    
    "RUN pip install -U pip setuptools",

    "RUN mkdir -p /usr/src/app",
    "WORKDIR /usr/src/app",
    "COPY ./ /usr/src/app",

    "RUN pip install --upgrade pip",
    "RUN pip install pipenv",
    "RUN pipenv lock --requirements > requirements.txt",
    "RUN pip install -r requirements.txt",
    "RUN python manage.py migrate",

    "EXPOSE 8100",
    "CMD sh /usr/src/app/run_web.sh"
  ]
}
